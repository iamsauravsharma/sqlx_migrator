<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Migrate trait which migrate a database according to requirements. This trait implements all methods which depends on DatabaseOperation trait. This trait is not required to implement any method since all have provided implementation and good to go for database agnostic case"><title>Migrate in sqlx_migrator::migrator - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-f3501f0f5ae15dfb.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="sqlx_migrator" data-themes="" data-resource-suffix="" data-rustdoc-version="1.71.0-nightly (2f2c438dc 2023-05-08)" data-search-js="search-4926e5fc22a5646a.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-6f6ffb5395b17c6e.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../../static.files/storage-62ce34ea385b278a.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-f0540c1d82cde29b.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../sqlx_migrator/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../sqlx_migrator/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Migrate</a></h2><div class="sidebar-elems"><section><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.apply_all">apply_all</a></li><li><a href="#method.apply_migration">apply_migration</a></li><li><a href="#method.generate_migration_plan">generate_migration_plan</a></li><li><a href="#method.list_applied_migrations">list_applied_migrations</a></li><li><a href="#method.revert_all">revert_all</a></li><li><a href="#method.revert_migration">revert_migration</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In sqlx_migrator::migrator</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="../index.html">sqlx_migrator</a>::<wbr><a href="index.html">migrator</a>::<wbr><a class="trait" href="#">Migrate</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/sqlx_migrator/migrator/mod.rs.html#312-566">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait Migrate&lt;DB&gt;: <a class="trait" href="trait.Info.html" title="trait sqlx_migrator::migrator::Info">Info</a>&lt;DB&gt; + <a class="trait" href="trait.DatabaseOperation.html" title="trait sqlx_migrator::migrator::DatabaseOperation">DatabaseOperation</a>&lt;DB&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a><span class="where fmt-newline">where
    DB: Database,</span>{
    // Provided methods
    fn <a href="#method.list_applied_migrations" class="fn">list_applied_migrations</a>&lt;'life0, 'async_trait&gt;(
        &amp;'life0 self
    ) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;&amp;'_ <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="../migration/trait.Migration.html" title="trait sqlx_migrator::migration::Migration">Migration</a>&lt;DB&gt;&gt;&gt;, <a class="enum" href="../error/enum.Error.html" title="enum sqlx_migrator::error::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;
       <span class="where">where Self: 'async_trait,
             'life0: 'async_trait</span> { ... }
<span class="item-spacer"></span>    fn <a href="#method.generate_migration_plan" class="fn">generate_migration_plan</a>&lt;'life0, 'async_trait&gt;(
        &amp;'life0 self,
        plan: <a class="struct" href="struct.Plan.html" title="struct sqlx_migrator::migrator::Plan">Plan</a>
    ) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;&amp;'_ <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="../migration/trait.Migration.html" title="trait sqlx_migrator::migration::Migration">Migration</a>&lt;DB&gt;&gt;&gt;, <a class="enum" href="../error/enum.Error.html" title="enum sqlx_migrator::error::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;
       <span class="where">where Self: 'async_trait,
             'life0: 'async_trait</span> { ... }
<span class="item-spacer"></span>    fn <a href="#method.apply_all" class="fn">apply_all</a>&lt;'life0, 'async_trait&gt;(
        &amp;'life0 self
    ) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>, <a class="enum" href="../error/enum.Error.html" title="enum sqlx_migrator::error::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;
       <span class="where">where Self: 'async_trait,
             'life0: 'async_trait</span> { ... }
<span class="item-spacer"></span>    fn <a href="#method.apply_migration" class="fn">apply_migration</a>&lt;'life0, 'life1, 'async_trait&gt;(
        &amp;'life0 self,
        migration: &amp;'life1 <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="../migration/trait.Migration.html" title="trait sqlx_migrator::migration::Migration">Migration</a>&lt;DB&gt;&gt;
    ) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>, <a class="enum" href="../error/enum.Error.html" title="enum sqlx_migrator::error::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;
       <span class="where">where Self: 'async_trait,
             'life0: 'async_trait,
             'life1: 'async_trait</span> { ... }
<span class="item-spacer"></span>    fn <a href="#method.revert_all" class="fn">revert_all</a>&lt;'life0, 'async_trait&gt;(
        &amp;'life0 self
    ) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>, <a class="enum" href="../error/enum.Error.html" title="enum sqlx_migrator::error::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;
       <span class="where">where Self: 'async_trait,
             'life0: 'async_trait</span> { ... }
<span class="item-spacer"></span>    fn <a href="#method.revert_migration" class="fn">revert_migration</a>&lt;'life0, 'life1, 'async_trait&gt;(
        &amp;'life0 self,
        migration: &amp;'life1 <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="../migration/trait.Migration.html" title="trait sqlx_migrator::migration::Migration">Migration</a>&lt;DB&gt;&gt;
    ) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>, <a class="enum" href="../error/enum.Error.html" title="enum sqlx_migrator::error::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;
       <span class="where">where Self: 'async_trait,
             'life0: 'async_trait,
             'life1: 'async_trait</span> { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Migrate trait which migrate a database according to requirements. This trait
implements all methods which depends on DatabaseOperation trait. This trait
is not required to implement any method since all have provided
implementation and good to go for database agnostic case</p>
<h2 id="example"><a href="#example">Example</a></h2>
<p>Create own custom Migrator which only supports postgres and uses own unique
table name instead of default table name</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::collections::HashSet;

<span class="kw">use </span>sqlx::{Pool, Postgres};
<span class="kw">use </span>sqlx_migrator::error::Error;
<span class="kw">use </span>sqlx_migrator::migration::{AppliedMigrationSqlRow, Migration};
<span class="kw">use </span>sqlx_migrator::migrator::{DatabaseOperation, Info, Migrate};

<span class="kw">pub struct </span>CustomMigrator {
    migrations: HashSet&lt;Box&lt;<span class="kw">dyn </span>Migration&lt;Postgres&gt;&gt;&gt;,
    pool: Pool&lt;Postgres&gt;,
}

<span class="kw">impl </span>Info&lt;Postgres&gt; <span class="kw">for </span>CustomMigrator {
    <span class="kw">fn </span>migrations(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; <span class="kw-2">&amp;</span>HashSet&lt;Box&lt;<span class="kw">dyn </span>Migration&lt;Postgres&gt;&gt;&gt; {
        <span class="kw-2">&amp;</span><span class="self">self</span>.migrations
    }

    <span class="kw">fn </span>migrations_mut(<span class="kw-2">&amp;mut </span><span class="self">self</span>) -&gt; <span class="kw-2">&amp;mut </span>HashSet&lt;Box&lt;<span class="kw">dyn </span>Migration&lt;Postgres&gt;&gt;&gt; {
        <span class="kw-2">&amp;mut </span><span class="self">self</span>.migrations
    }

    <span class="kw">fn </span>pool(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; <span class="kw-2">&amp;</span>Pool&lt;Postgres&gt; {
        <span class="kw-2">&amp;</span><span class="self">self</span>.pool
    }
}
<span class="attr">#[must_use]
</span><span class="kw">pub</span>(<span class="kw">crate</span>) <span class="kw">fn </span>create_migrator_table_query() -&gt; <span class="kw-2">&amp;</span><span class="lifetime">&#39;static </span>str {
    <span class="string">&quot;CREATE TABLE IF NOT EXISTS _custom_migrator_table_name (
       id INT PRIMARY KEY NOT NULL GENERATED ALWAYS AS IDENTITY,
       app TEXT NOT NULL,
       name TEXT NOT NULL,
       applied_time TIMESTAMPTZ NOT NULL DEFAULT now(),
       UNIQUE (app, name)
   )&quot;
</span>}

<span class="attr">#[must_use]
</span><span class="kw">pub</span>(<span class="kw">crate</span>) <span class="kw">fn </span>drop_table_query() -&gt; <span class="kw-2">&amp;</span><span class="lifetime">&#39;static </span>str {
    <span class="string">&quot;DROP TABLE IF EXISTS _custom_migrator_table_name&quot;
</span>}

<span class="attr">#[must_use]
</span><span class="kw">pub</span>(<span class="kw">crate</span>) <span class="kw">fn </span>fetch_row_query() -&gt; <span class="kw-2">&amp;</span><span class="lifetime">&#39;static </span>str {
    <span class="string">&quot;SELECT id, app, name, applied_time FROM _custom_migrator_table_name&quot;
</span>}

<span class="attr">#[must_use]
</span><span class="kw">pub</span>(<span class="kw">crate</span>) <span class="kw">fn </span>add_migration_query() -&gt; <span class="kw-2">&amp;</span><span class="lifetime">&#39;static </span>str {
    <span class="string">&quot;INSERT INTO _custom_migrator_table_name(app, name) VALUES ($1, $2)&quot;
</span>}

<span class="attr">#[must_use]
</span><span class="kw">pub</span>(<span class="kw">crate</span>) <span class="kw">fn </span>delete_migration_query() -&gt; <span class="kw-2">&amp;</span><span class="lifetime">&#39;static </span>str {
    <span class="string">&quot;DELETE FROM _custom_migrator_table_name WHERE app = $1 AND name = $2&quot;
</span>}

<span class="kw">pub</span>(<span class="kw">crate</span>) <span class="kw">async fn </span>lock_database(pool: <span class="kw-2">&amp;</span>Pool&lt;Postgres&gt;) -&gt; <span class="prelude-ty">Result</span>&lt;(), Error&gt; {
    <span class="kw">let </span>database = pool.connect_options().get_database().unwrap_or_default();
    <span class="kw">let </span>lock_id = i64::from(crc32fast::hash(database.as_bytes()));
    sqlx::query(
        <span class="string">&quot;SELECT
pg_advisory_lock($1)&quot;</span>,
    )
    .bind(lock_id)
    .execute(pool)
    .<span class="kw">await</span><span class="question-mark">?</span>;
    <span class="prelude-val">Ok</span>(())
}

<span class="kw">pub</span>(<span class="kw">crate</span>) <span class="kw">async fn </span>unlock_database(pool: <span class="kw-2">&amp;</span>Pool&lt;Postgres&gt;) -&gt; <span class="prelude-ty">Result</span>&lt;(), Error&gt; {
    <span class="kw">let </span>database = pool.connect_options().get_database().unwrap_or_default();
    <span class="kw">let </span>lock_id = i64::from(crc32fast::hash(database.as_bytes()));
    sqlx::query(
        <span class="string">&quot;SELECT
pg_advisory_unlock($1)&quot;</span>,
    )
    .bind(lock_id)
    .execute(pool)
    .<span class="kw">await</span><span class="question-mark">?</span>;
    <span class="prelude-val">Ok</span>(())
}

<span class="attr">#[async_trait::async_trait]
</span><span class="kw">impl </span>DatabaseOperation&lt;Postgres&gt; <span class="kw">for </span>CustomMigrator {
    <span class="kw">async fn </span>ensure_migration_table_exists(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; <span class="prelude-ty">Result</span>&lt;(), Error&gt; {
        sqlx::query(create_migrator_table_query())
            .execute(<span class="kw-2">&amp;</span><span class="self">self</span>.pool)
            .<span class="kw">await</span><span class="question-mark">?</span>;
        <span class="prelude-val">Ok</span>(())
    }

    <span class="kw">async fn </span>drop_migration_table_if_exists(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; <span class="prelude-ty">Result</span>&lt;(), Error&gt; {
        sqlx::query(drop_table_query()).execute(<span class="kw-2">&amp;</span><span class="self">self</span>.pool).<span class="kw">await</span><span class="question-mark">?</span>;
        <span class="prelude-val">Ok</span>(())
    }

    <span class="kw">async fn </span>add_migration_to_db_table(
        <span class="kw-2">&amp;</span><span class="self">self</span>,
        migration: <span class="kw-2">&amp;</span>Box&lt;<span class="kw">dyn </span>Migration&lt;Postgres&gt;&gt;,
        connection: <span class="kw-2">&amp;mut </span>&lt;Postgres <span class="kw">as </span>sqlx::Database&gt;::Connection,
    ) -&gt; <span class="prelude-ty">Result</span>&lt;(), Error&gt; {
        sqlx::query(add_migration_query())
            .bind(migration.app())
            .bind(migration.name())
            .execute(connection)
            .<span class="kw">await</span><span class="question-mark">?</span>;
        <span class="prelude-val">Ok</span>(())
    }

    <span class="kw">async fn </span>delete_migration_from_db_table(
        <span class="kw-2">&amp;</span><span class="self">self</span>,
        migration: <span class="kw-2">&amp;</span>Box&lt;<span class="kw">dyn </span>Migration&lt;Postgres&gt;&gt;,
        connection: <span class="kw-2">&amp;mut </span>&lt;Postgres <span class="kw">as </span>sqlx::Database&gt;::Connection,
    ) -&gt; <span class="prelude-ty">Result</span>&lt;(), Error&gt; {
        sqlx::query(delete_migration_query())
            .bind(migration.app())
            .bind(migration.name())
            .execute(connection)
            .<span class="kw">await</span><span class="question-mark">?</span>;
        <span class="prelude-val">Ok</span>(())
    }

    <span class="kw">async fn </span>fetch_applied_migration_from_db(
        <span class="kw-2">&amp;</span><span class="self">self</span>,
    ) -&gt; <span class="prelude-ty">Result</span>&lt;Vec&lt;AppliedMigrationSqlRow&gt;, Error&gt; {
        <span class="kw">let </span>rows = sqlx::query_as(fetch_row_query())
            .fetch_all(<span class="kw-2">&amp;</span><span class="self">self</span>.pool)
            .<span class="kw">await</span><span class="question-mark">?</span>;
        <span class="prelude-val">Ok</span>(rows)
    }

    <span class="kw">async fn </span>lock(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; <span class="prelude-ty">Result</span>&lt;(), Error&gt; {
        lock_database(<span class="kw-2">&amp;</span><span class="self">self</span>.pool).<span class="kw">await
    </span>}

    <span class="kw">async fn </span>unlock(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; <span class="prelude-ty">Result</span>&lt;(), Error&gt; {
        unlock_database(<span class="kw-2">&amp;</span><span class="self">self</span>.pool).<span class="kw">await
    </span>}
}

<span class="kw">impl </span>Migrate&lt;Postgres&gt; <span class="kw">for </span>CustomMigrator {}</code></pre></div>
</div></details><h2 id="provided-methods" class="small-section-header">Provided Methods<a href="#provided-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.list_applied_migrations" class="method"><a class="srclink rightside" href="../../src/sqlx_migrator/migrator/mod.rs.html#317-337">source</a><h4 class="code-header">fn <a href="#method.list_applied_migrations" class="fn">list_applied_migrations</a>&lt;'life0, 'async_trait&gt;(
    &amp;'life0 self
) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;&amp;'_ <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="../migration/trait.Migration.html" title="trait sqlx_migrator::migration::Migration">Migration</a>&lt;DB&gt;&gt;&gt;, <a class="enum" href="../error/enum.Error.html" title="enum sqlx_migrator::error::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;<span class="where fmt-newline">where
    Self: 'async_trait,
    'life0: 'async_trait,</span></h4></section></summary><div class="docblock"><p>List all applied migrations. Returns a vector of migration</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.generate_migration_plan" class="method"><a class="srclink rightside" href="../../src/sqlx_migrator/migrator/mod.rs.html#341-464">source</a><h4 class="code-header">fn <a href="#method.generate_migration_plan" class="fn">generate_migration_plan</a>&lt;'life0, 'async_trait&gt;(
    &amp;'life0 self,
    plan: <a class="struct" href="struct.Plan.html" title="struct sqlx_migrator::migrator::Plan">Plan</a>
) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;&amp;'_ <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="../migration/trait.Migration.html" title="trait sqlx_migrator::migration::Migration">Migration</a>&lt;DB&gt;&gt;&gt;, <a class="enum" href="../error/enum.Error.html" title="enum sqlx_migrator::error::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;<span class="where fmt-newline">where
    Self: 'async_trait,
    'life0: 'async_trait,</span></h4></section></summary><div class="docblock"><p>Generate migration plan for according to plan type. Returns a vector of
migration</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.apply_all" class="method"><a class="srclink rightside" href="../../src/sqlx_migrator/migrator/mod.rs.html#470-483">source</a><h4 class="code-header">fn <a href="#method.apply_all" class="fn">apply_all</a>&lt;'life0, 'async_trait&gt;(
    &amp;'life0 self
) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>, <a class="enum" href="../error/enum.Error.html" title="enum sqlx_migrator::error::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;<span class="where fmt-newline">where
    Self: 'async_trait,
    'life0: 'async_trait,</span></h4></section></summary><div class="docblock"><p>Apply missing migration</p>
<h5 id="errors"><a href="#errors">Errors</a></h5>
<p>If failed to apply migration</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.apply_migration" class="method"><a class="srclink rightside" href="../../src/sqlx_migrator/migrator/mod.rs.html#487-512">source</a><h4 class="code-header">fn <a href="#method.apply_migration" class="fn">apply_migration</a>&lt;'life0, 'life1, 'async_trait&gt;(
    &amp;'life0 self,
    migration: &amp;'life1 <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="../migration/trait.Migration.html" title="trait sqlx_migrator::migration::Migration">Migration</a>&lt;DB&gt;&gt;
) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>, <a class="enum" href="../error/enum.Error.html" title="enum sqlx_migrator::error::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;<span class="where fmt-newline">where
    Self: 'async_trait,
    'life0: 'async_trait,
    'life1: 'async_trait,</span></h4></section></summary><div class="docblock"><p>Apply given migration and add it to applied migration table</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.revert_all" class="method"><a class="srclink rightside" href="../../src/sqlx_migrator/migrator/mod.rs.html#518-531">source</a><h4 class="code-header">fn <a href="#method.revert_all" class="fn">revert_all</a>&lt;'life0, 'async_trait&gt;(
    &amp;'life0 self
) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>, <a class="enum" href="../error/enum.Error.html" title="enum sqlx_migrator::error::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;<span class="where fmt-newline">where
    Self: 'async_trait,
    'life0: 'async_trait,</span></h4></section></summary><div class="docblock"><p>Revert all applied migration from database</p>
<h5 id="errors-1"><a href="#errors-1">Errors</a></h5>
<p>If any migration or operation fails</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.revert_migration" class="method"><a class="srclink rightside" href="../../src/sqlx_migrator/migrator/mod.rs.html#535-565">source</a><h4 class="code-header">fn <a href="#method.revert_migration" class="fn">revert_migration</a>&lt;'life0, 'life1, 'async_trait&gt;(
    &amp;'life0 self,
    migration: &amp;'life1 <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="../migration/trait.Migration.html" title="trait sqlx_migrator::migration::Migration">Migration</a>&lt;DB&gt;&gt;
) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>, <a class="enum" href="../error/enum.Error.html" title="enum sqlx_migrator::error::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;<span class="where fmt-newline">where
    Self: 'async_trait,
    'life0: 'async_trait,
    'life1: 'async_trait,</span></h4></section></summary><div class="docblock"><p>Revert provided migration and remove migration from table</p>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><section id="impl-Migrate%3CAny%3E-for-Migrator%3CAny%3E" class="impl"><a class="srclink rightside" href="../../src/sqlx_migrator/migrator/any.rs.html#157">source</a><a href="#impl-Migrate%3CAny%3E-for-Migrator%3CAny%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.Migrate.html" title="trait sqlx_migrator::migrator::Migrate">Migrate</a>&lt;Any&gt; for <a class="struct" href="struct.Migrator.html" title="struct sqlx_migrator::migrator::Migrator">Migrator</a>&lt;Any&gt;</h3><span class="item-info"><div class="stab portability">Available on <strong>(crate features <code>postgres</code> or <code>mysql</code> or <code>sqlite</code>) and crate feature <code>any</code></strong> only.</div></span></section><section id="impl-Migrate%3CMySql%3E-for-Migrator%3CMySql%3E" class="impl"><a class="srclink rightside" href="../../src/sqlx_migrator/migrator/mysql.rs.html#125">source</a><a href="#impl-Migrate%3CMySql%3E-for-Migrator%3CMySql%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.Migrate.html" title="trait sqlx_migrator::migrator::Migrate">Migrate</a>&lt;MySql&gt; for <a class="struct" href="struct.Migrator.html" title="struct sqlx_migrator::migrator::Migrator">Migrator</a>&lt;MySql&gt;</h3><span class="item-info"><div class="stab portability">Available on <strong>crate feature <code>mysql</code></strong> only.</div></span></section><section id="impl-Migrate%3CPostgres%3E-for-Migrator%3CPostgres%3E" class="impl"><a class="srclink rightside" href="../../src/sqlx_migrator/migrator/postgres.rs.html#125">source</a><a href="#impl-Migrate%3CPostgres%3E-for-Migrator%3CPostgres%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.Migrate.html" title="trait sqlx_migrator::migrator::Migrate">Migrate</a>&lt;Postgres&gt; for <a class="struct" href="struct.Migrator.html" title="struct sqlx_migrator::migrator::Migrator">Migrator</a>&lt;Postgres&gt;</h3><span class="item-info"><div class="stab portability">Available on <strong>crate feature <code>postgres</code></strong> only.</div></span></section><section id="impl-Migrate%3CSqlite%3E-for-Migrator%3CSqlite%3E" class="impl"><a class="srclink rightside" href="../../src/sqlx_migrator/migrator/sqlite.rs.html#99">source</a><a href="#impl-Migrate%3CSqlite%3E-for-Migrator%3CSqlite%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.Migrate.html" title="trait sqlx_migrator::migrator::Migrate">Migrate</a>&lt;Sqlite&gt; for <a class="struct" href="struct.Migrator.html" title="struct sqlx_migrator::migrator::Migrator">Migrator</a>&lt;Sqlite&gt;</h3><span class="item-info"><div class="stab portability">Available on <strong>crate feature <code>sqlite</code></strong> only.</div></span></section></div><script src="../../implementors/sqlx_migrator/migrator/trait.Migrate.js" async></script></section></div></main></body></html>